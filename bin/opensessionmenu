#!/bin/bash

S_ROOT_FOLDER=/usr/lib/ws-session

source $S_ROOT_FOLDER/lib/source.sh
s_source_rc

source $S_ROOT_FOLDER/lib/data.sh
source $S_ROOT_FOLDER/lib/wm.sh
source $S_ROOT_FOLDER/lib/session.sh
for app in ${S_APPLICATIONS[@]} ; do
  s_source app/$app.sh
done

AVAILABLE=$(for d in ~/.local/share/sess/* ; do basename $d | sed 's/-[0-5]$//' ; done | uniq)
OPEN=$(s_list_open_tags)
TOOPEN=$( printf "$AVAILABLE\n$OPEN" | sort | uniq -u | grep -v ^$)

if [[ -z $1 && -n $S_MENU ]] ;then
        startsession="$(printf "$TOOPEN" | $S_MENU -p "choose a session:")"
        [[ -n $startsession ]] && s_opensession $startsession
elif [[ $TOOPEN =~ $1 ]] ; then
        s_opensession $1
else
        echo Available sessions: $TOOPEN
        "The session manager says"
fi

# vim: ft=sh ts=2 et sw=2:

