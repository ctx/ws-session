#!/bin/bash

SESSIONPATH=/usr/lib/ws-session

source $SESSIONPATH/lib/rc.sh

source $SESSIONPATH/lib/data.sh
source $SESSIONPATH/lib/wm.sh
source $SESSIONPATH/lib/session.sh
for app in ${SAAPPLICATIONS[@]} ${APPLICATIONS[@]} ; do
  source $SESSIONPATH/app/$app.sh
done

#AVAILABLE=$(ls "$DATA_HOME" | sed 's/-[0-5]$//g' | sort -u)
AVAILABLE=$(for d in ~/.local/share/sess/* ; do sed 's/-[0-5]$//' <((basename $d)) ; done | uniq)
OPEN=$(xprop -root _NET_DESKTOP_NAMES|sed 's/.*=//;s/\"//g;s/, /\n/g;s/^ *//g;s/ *$//g')
TOOPEN=$( printf "$AVAILABLE\n$OPEN" | sort | uniq -u | grep -v ^$)

if [[ -z $1 && -n $MENU ]] ;then
        startsession="$(printf "$TOOPEN" | $MENU -p "choose a session:")"
        [[ -n $startsession ]] && s_opensession $startsession
elif [[ $TOOPEN =~ $1 ]] ; then
        s_opensession $1
else
        echo Available sessions: $TOOPEN
        "The session manager says"
fi

# vim: ft=sh ts=2 et sw=2:

